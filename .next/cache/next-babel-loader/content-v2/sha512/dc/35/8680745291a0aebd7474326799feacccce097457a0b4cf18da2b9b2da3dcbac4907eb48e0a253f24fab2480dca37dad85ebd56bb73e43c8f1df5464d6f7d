{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _defineProperty from \"/Users/naibtahmazli/Documents/166kargo/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/Users/naibtahmazli/Documents/166kargo/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport axios from \"axios\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport React, { memo, useState } from 'react';\nimport { useForm } from \"react-hook-form\";\nimport { connect } from \"react-redux\";\nimport Swal from \"sweetalert2\";\nimport AsideMenu from \"../components/aside-menu\";\nimport Aside from \"../components/aside/aside\";\nimport Button from \"../components/button\";\nimport Card from \"../components/card/card\";\nimport Checkbox from '../components/checkbox/checkbox';\nimport FromGroup from '../components/form-group/form-group';\nimport Input from '../components/input/input';\nimport Main from \"../components/main/main\";\nimport Page from \"../components/page/page\";\nimport Redirect from \"../components/redirect/redirect\";\n\nfunction NewOrder(props) {\n  if (!props.entry.isLoged) {\n    return /*#__PURE__*/_jsx(Redirect, {});\n  }\n\n  var _useRouter = useRouter(),\n      locale = _useRouter.locale;\n\n  var _useForm = useForm(),\n      register = _useForm.register,\n      handleSubmit = _useForm.handleSubmit,\n      errors = _useForm.errors,\n      setError = _useForm.setError,\n      clearErrors = _useForm.clearErrors;\n\n  var _useState = useState([{\n    url: {\n      value: '',\n      error: ''\n    },\n    price: {\n      value: '',\n      error: ''\n    },\n    notes: {\n      value: '',\n      error: ''\n    },\n    color: {\n      value: '',\n      error: ''\n    },\n    size: {\n      value: '',\n      error: ''\n    },\n    count: {\n      value: '',\n      error: ''\n    }\n  }]),\n      cards = _useState[0],\n      setCards = _useState[1];\n\n  var _useState2 = useState({\n    country: '15',\n    is_fast: 0,\n    ruleAccepted: false\n  }),\n      cardData = _useState2[0],\n      setCardData = _useState2[1];\n\n  var addCard = function addCard(ev) {\n    ev.preventDefault();\n    cards.push({\n      url: {\n        value: '',\n        error: ''\n      },\n      price: {\n        value: '',\n        error: ''\n      },\n      notes: {\n        value: '',\n        error: ''\n      },\n      color: {\n        value: '',\n        error: ''\n      },\n      size: {\n        value: '',\n        error: ''\n      },\n      count: {\n        value: '',\n        error: ''\n      }\n    });\n    setCards(_toConsumableArray(cards));\n  };\n\n  var removeCard = function removeCard(ev) {\n    var id = ev.target.getAttribute('data-id');\n    cards.splice(id, 1);\n    setCards(_toConsumableArray(cards));\n  };\n\n  var handleInput = function handleInput(ev) {\n    ev.stopPropagation();\n    var id = ev.target.getAttribute('data-id');\n    var _ev$target = ev.target,\n        name = _ev$target.name,\n        value = _ev$target.value;\n    cards[id] = _objectSpread(_objectSpread({}, cards[id]), {}, _defineProperty({}, name, _objectSpread(_objectSpread({}, cards[id][name]), {}, {\n      value: value\n    })));\n\n    if (cards[id].count && cards[id].price) {\n      cards[id] = _objectSpread(_objectSpread({}, cards[id]), {}, {\n        total: cardData.is_fast ? cards[id].count.value * cards[id].price.value + props.fastOrderPrice : cards[id].count.value * cards[id].price.value\n      });\n    } else {\n      cards[id] = _objectSpread(_objectSpread({}, cards[id]), {}, {\n        total: ''\n      });\n    }\n\n    setCards(_toConsumableArray(cards));\n  };\n\n  var addFastPrize = function addFastPrize(isfast, price) {\n    var newCards = cards;\n    newCards.forEach(function (x) {\n      return isfast ? x.total += price : x.total -= price;\n    }); // setCards([...newCards])\n  };\n\n  var submit = function submit() {\n    if (cardData.ruleAccepted) {\n      var data = _objectSpread(_objectSpread({}, cardData), {}, {\n        items: cards.map(function (x) {\n          var newObj = {};\n\n          for (var key in x) {\n            newObj[key] = x[key].value;\n          }\n\n          return newObj;\n        })\n      });\n\n      axios.post(\"\".concat(process.env.NEXT_PUBLIC_API_URL, \"orders?lan=\").concat(locale), data, {\n        headers: {\n          'Content-Type': 'application/json',\n          'Accepts': 'application/json',\n          'Authorization': \"Bearer \".concat(props.entry.user.accessToken)\n        }\n      }).then(function (res) {\n        Swal.fire({\n          success: 'success',\n          text: 'emeliyyat ugurlu oldu',\n          icon: 'success'\n        });\n      })[\"catch\"](function (err) {\n        var items = err.response.data.errors.items;\n        items.forEach(function (x, i) {\n          for (var key in x) {\n            cards[i] = _objectSpread(_objectSpread({}, cards[i]), {}, _defineProperty({}, key, _objectSpread(_objectSpread({}, cards[i][key]), {}, {\n              error: x[key]\n            })));\n          }\n        });\n        setCards(_toConsumableArray(cards));\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxs(Page, {\n    className: \"bg-bg pt-lg\",\n    children: [/*#__PURE__*/_jsx(Aside, {\n      className: \"mr-sm\",\n      children: /*#__PURE__*/_jsx(AsideMenu, {})\n    }), /*#__PURE__*/_jsxs(Main, {\n      className: \"br-sm bg-white br-lg\",\n      children: [/*#__PURE__*/_jsxs(Card, {\n        className: \"p-sm desktop__order\",\n        children: [/*#__PURE__*/_jsx(Card.Header, {\n          text: \"Yeni sifaris\"\n        }), /*#__PURE__*/_jsxs(\"form\", {\n          onSubmit: handleSubmit(submit),\n          children: [cards.map(function (x, i) {\n            return /*#__PURE__*/_jsxs(Card.Body, {\n              className: \"bg-yellow p-sm br-lg mb-xs p-r\",\n              children: [i > 0 ? /*#__PURE__*/_jsx(\"span\", {\n                onClick: removeCard,\n                \"data-id\": i,\n                style: {\n                  color: 'red',\n                  position: 'absolute',\n                  top: '10px',\n                  right: '10px',\n                  cursor: 'pointer'\n                },\n                children: \"\\u2716\"\n              }) : /*#__PURE__*/_jsx(_Fragment, {}), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"\",\n                style: {\n                  display: 'flex'\n                },\n                children: [/*#__PURE__*/_jsxs(\"div\", {\n                  className: \"w-50 mr-sm\",\n                  style: {},\n                  children: [/*#__PURE__*/_jsx(FromGroup, {\n                    label: \"Link\",\n                    className: \"w-100\",\n                    bodyClass: \"bg-white\",\n                    error: x.url.error,\n                    children: /*#__PURE__*/_jsx(Input, {\n                      type: \"text\",\n                      name: \"url\",\n                      \"data-id\": i,\n                      value: x.url.value,\n                      Ref: register({\n                        required: true\n                      }),\n                      onChange: handleInput\n                    })\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    style: {\n                      display: 'flex'\n                    },\n                    children: [/*#__PURE__*/_jsx(FromGroup, {\n                      label: \"Rengi\",\n                      className: \"w-50 mr-sm\",\n                      bodyClass: \"bg-white\",\n                      error: x.color.error,\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"text\",\n                        name: \"color\",\n                        \"data-id\": i,\n                        value: x.color.value,\n                        Ref: register({\n                          required: true\n                        }),\n                        onChange: handleInput\n                      })\n                    }), /*#__PURE__*/_jsx(FromGroup, {\n                      label: \"Olcusu\",\n                      className: \"w-50\",\n                      bodyClass: \"bg-white\",\n                      error: x.size.error,\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"text\",\n                        name: \"size\",\n                        \"data-id\": i,\n                        value: x.size.value,\n                        Ref: register({\n                          required: true\n                        }),\n                        onChange: handleInput\n                      })\n                    })]\n                  })]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"w-50\",\n                  children: [/*#__PURE__*/_jsxs(\"div\", {\n                    className: \"w-100\",\n                    style: {\n                      display: 'flex',\n                      justifyContent: 'space-between'\n                    },\n                    children: [/*#__PURE__*/_jsx(FromGroup, {\n                      label: \"Mehsul sayi\",\n                      className: \"mr-xs\",\n                      bodyClass: \"bg-white\",\n                      error: x.count.error,\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"number\",\n                        name: \"count\",\n                        \"data-id\": i,\n                        value: x.count.value,\n                        Ref: register({\n                          required: true\n                        }),\n                        onChange: handleInput\n                      })\n                    }), /*#__PURE__*/_jsx(FromGroup, {\n                      label: \"Qiymet\",\n                      className: \"mr-xs\",\n                      bodyClass: \"bg-white\",\n                      error: x.price.error,\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"number\",\n                        name: \"price\",\n                        \"data-id\": i,\n                        value: x.price.value,\n                        Ref: register({\n                          required: true\n                        }),\n                        onChange: handleInput\n                      })\n                    }), /*#__PURE__*/_jsx(FromGroup, {\n                      label: \"Cemi\",\n                      className: \"mr-xs\",\n                      bodyClass: \"bg-white\",\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"number\",\n                        name: \"total\",\n                        \"data-id\": i,\n                        value: x.total,\n                        Ref: register({\n                          required: true\n                        }),\n                        disabled: true\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsx(FromGroup, {\n                    label: \"Elave Qeyd\",\n                    className: \"w-100\",\n                    bodyClass: \"bg-white\",\n                    error: x.notes.error,\n                    children: /*#__PURE__*/_jsx(Input, {\n                      type: \"text\",\n                      name: \"notes\",\n                      \"data-id\": i,\n                      value: x.notes.value,\n                      Ref: register({\n                        required: true\n                      }),\n                      onChange: handleInput\n                    })\n                  })]\n                })]\n              })]\n            }, i);\n          }), /*#__PURE__*/_jsxs(Card.Footer, {\n            className: \"mt-sm\",\n            style: {\n              justifyContent: 'space-between'\n            },\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              children: /*#__PURE__*/_jsx(Button, {\n                onClick: addCard,\n                className: \"w-100 p-sm bg-white border-success color-success\",\n                startElement: /*#__PURE__*/_jsx(\"span\", {\n                  className: \"mr-xs color-success\",\n                  children: \"+\"\n                }),\n                label: \"Yeni mehsul artir\"\n              })\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              style: {\n                display: 'flex',\n                alignItems: 'center'\n              },\n              children: [/*#__PURE__*/_jsx(Checkbox, {\n                text: \"Tecili\",\n                name: \"is_fast\",\n                value: cardData.is_fast,\n                onClick: function onClick(ev) {\n                  setCardData(_objectSpread(_objectSpread({}, cardData), {}, {\n                    is_fast: +ev.target.checked\n                  }));\n                  addFastPrize(ev.target.checked, props.fastOrderPrice);\n                }\n              }), /*#__PURE__*/_jsx(Checkbox, {\n                onClick: function onClick(ev) {\n                  setCardData(_objectSpread(_objectSpread({}, cardData), {}, {\n                    ruleAccepted: ev.target.checked\n                  }));\n                },\n                children: /*#__PURE__*/_jsx(Link, {\n                  href: \"/\",\n                  children: /*#__PURE__*/_jsxs(_Fragment, {\n                    children: [/*#__PURE__*/_jsx(\"a\", {\n                      className: \"mr-xs\",\n                      style: {\n                        width: '-webkit-max-content'\n                      },\n                      children: \"Qaydalarla\"\n                    }), \"Raziyam\"]\n                  })\n                })\n              }), /*#__PURE__*/_jsx(Button, {\n                style: {\n                  padding: '0 5px'\n                },\n                label: \"Sifari\\u015F et v\\u0259 \\xF6de\",\n                endElement: /*#__PURE__*/_jsx(\"span\", {\n                  className: \"ml-xs\",\n                  children: \"\\u203A\"\n                }),\n                className: \" w-100\",\n                disabled: !cardData.ruleAccepted\n              })]\n            })]\n          })]\n        })]\n      }), /*#__PURE__*/_jsxs(Card, {\n        className: \"p-sm mobile__order\",\n        children: [/*#__PURE__*/_jsx(Card.Header, {\n          text: \"Yeni sifaris\"\n        }), /*#__PURE__*/_jsxs(\"form\", {\n          onSubmit: handleSubmit(submit),\n          children: [cards.map(function (x, i) {\n            return /*#__PURE__*/_jsxs(Card.Body, {\n              className: \"bg-yellow p-sm br-lg mb-xs p-r\",\n              children: [i > 0 ? /*#__PURE__*/_jsx(\"span\", {\n                onClick: removeCard,\n                \"data-id\": i,\n                style: {\n                  color: 'red',\n                  position: 'absolute',\n                  top: '10px',\n                  right: '10px',\n                  cursor: 'pointer'\n                },\n                children: \"\\u2716\"\n              }) : /*#__PURE__*/_jsx(_Fragment, {}), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"\",\n                children: [/*#__PURE__*/_jsxs(\"div\", {\n                  children: [/*#__PURE__*/_jsx(FromGroup, {\n                    label: \"Link\",\n                    className: \"w-100\",\n                    bodyClass: \"bg-white\",\n                    error: x.url.error,\n                    children: /*#__PURE__*/_jsx(Input, {\n                      type: \"text\",\n                      name: \"url\",\n                      \"data-id\": i,\n                      value: x.url.value,\n                      Ref: register({\n                        required: true\n                      }),\n                      onChange: handleInput\n                    })\n                  }), /*#__PURE__*/_jsx(FromGroup, {\n                    label: \"Mehsul sayi\",\n                    bodyClass: \"bg-white\",\n                    error: x.count.error,\n                    children: /*#__PURE__*/_jsx(Input, {\n                      type: \"number\",\n                      name: \"count\",\n                      \"data-id\": i,\n                      value: x.count.value,\n                      Ref: register({\n                        required: true\n                      }),\n                      onChange: handleInput\n                    })\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"w-100\",\n                    style: {\n                      display: 'flex',\n                      justifyContent: 'space-between'\n                    },\n                    children: [/*#__PURE__*/_jsx(FromGroup, {\n                      label: \"Qiymet\",\n                      className: \" w-50 mr-xs\",\n                      bodyClass: \"bg-white\",\n                      error: x.price.error,\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"number\",\n                        name: \"price\",\n                        \"data-id\": i,\n                        value: x.price.value,\n                        Ref: register({\n                          required: true\n                        }),\n                        onChange: handleInput\n                      })\n                    }), /*#__PURE__*/_jsx(FromGroup, {\n                      label: \"Cemi\",\n                      className: \" w-50\",\n                      bodyClass: \"bg-white\",\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"number\",\n                        name: \"total\",\n                        \"data-id\": i,\n                        value: x.total,\n                        Ref: register({\n                          required: true\n                        }),\n                        disabled: true\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    style: {\n                      display: 'flex'\n                    },\n                    children: [/*#__PURE__*/_jsx(FromGroup, {\n                      label: \"Rengi\",\n                      className: \"w-50 mr-xs\",\n                      bodyClass: \"bg-white\",\n                      error: x.color.error,\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"text\",\n                        name: \"color\",\n                        \"data-id\": i,\n                        value: x.color.value,\n                        Ref: register({\n                          required: true\n                        }),\n                        onChange: handleInput\n                      })\n                    }), /*#__PURE__*/_jsx(FromGroup, {\n                      label: \"Olcusu\",\n                      className: \"w-50\",\n                      bodyClass: \"bg-white\",\n                      error: x.size.error,\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"text\",\n                        name: \"size\",\n                        \"data-id\": i,\n                        value: x.size.value,\n                        Ref: register({\n                          required: true\n                        }),\n                        onChange: handleInput\n                      })\n                    })]\n                  })]\n                }), /*#__PURE__*/_jsx(\"div\", {\n                  children: /*#__PURE__*/_jsx(FromGroup, {\n                    label: \"Elave Qeyd\",\n                    className: \"w-100\",\n                    bodyClass: \"bg-white\",\n                    error: x.notes.error,\n                    children: /*#__PURE__*/_jsx(Input, {\n                      type: \"text\",\n                      name: \"notes\",\n                      \"data-id\": i,\n                      value: x.notes.value,\n                      Ref: register({\n                        required: true\n                      }),\n                      onChange: handleInput\n                    })\n                  })\n                })]\n              })]\n            }, i);\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"mt-sm\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              children: /*#__PURE__*/_jsx(Button, {\n                onClick: addCard,\n                className: \"w-100 p-sm bg-white border-success color-success\",\n                startElement: /*#__PURE__*/_jsx(\"span\", {\n                  className: \"mr-xs color-success\",\n                  children: \"+\"\n                }),\n                label: \"Yeni mehsul artir\"\n              })\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              style: {\n                display: 'flex',\n                alignItems: 'center',\n                margin: '10px 0'\n              },\n              children: [/*#__PURE__*/_jsx(Checkbox, {\n                text: \"Tecili\",\n                name: \"is_fast\",\n                value: cardData.is_fast,\n                onClick: function onClick(ev) {\n                  setCardData(_objectSpread(_objectSpread({}, cardData), {}, {\n                    is_fast: +ev.target.checked\n                  }));\n                  addFastPrize(ev.target.checked, props.fastOrderPrice);\n                }\n              }), /*#__PURE__*/_jsx(Checkbox, {\n                onClick: function onClick(ev) {\n                  setCardData(_objectSpread(_objectSpread({}, cardData), {}, {\n                    ruleAccepted: ev.target.checked\n                  }));\n                },\n                children: /*#__PURE__*/_jsx(Link, {\n                  href: \"/\",\n                  children: /*#__PURE__*/_jsxs(_Fragment, {\n                    children: [/*#__PURE__*/_jsx(\"a\", {\n                      className: \"mr-xs\",\n                      style: {\n                        width: '-webkit-max-content'\n                      },\n                      children: \"Qaydalarla\"\n                    }), \"Raziyam\"]\n                  })\n                })\n              })]\n            }), /*#__PURE__*/_jsx(Button, {\n              style: {\n                padding: '0 5px'\n              },\n              label: \"Sifari\\u015F et v\\u0259 \\xF6de\",\n              endElement: /*#__PURE__*/_jsx(\"span\", {\n                className: \"ml-xs\",\n                children: \"\\u203A\"\n              }),\n              className: \" w-100\",\n              disabled: !cardData.ruleAccepted\n            })]\n          })]\n        })]\n      })]\n    })]\n  });\n}\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    entry: state.entry,\n    fastOrderPrice: state.settings.data.fast_order_fixed_price,\n    serviceFeePersentage: state.settings.data.service_fee_percent\n  };\n};\n\nexport default connect(mapStateToProps)( /*#__PURE__*/memo(NewOrder));","map":null,"metadata":{},"sourceType":"module"}